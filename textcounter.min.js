/*!
* jQuery Text Counter Plugin v0.8.0
* https://github.com/ractoon/jQuery-Text-Counter
*
* Copyright 2014 ractoon
* Released under the MIT license
*/
!function(f){f.textcounter=function(t,r){var C=this;C.$el=f(t),C.el=t,C.$el.data("textcounter",C),C.init=function(){C.options=f.extend({},f.textcounter.defaultOptions,r);var t=C.options.countDown?C.options.countDownText:C.options.counterText,o=C.options.countDown?C.options.max:0,n=f("<div/>").addClass(C.options.textCountMessageClass).html(t.replace("%d",'<span class="'+C.options.textCountClass+'">'+o+"</span>")),e=f("<div/>").addClass(C.options.countOverflowContainerClass);C.hideMessage(e),C.$container=f("<"+C.options.countContainerElement+"/>").addClass(C.options.countContainerClass).append(n).append(e),C.$text_counter=C.$container.find("span"),C.$el.after(C.$container),C.$el.bind("keyup.textcounter click.textcounter blur.textcounter focus.textcounter change.textcounter paste.textcounter",C.checkLimits).trigger("click.textcounter"),C.options.init(C.el)},C.checkLimits=function(t){var o=C.$el,n=(C.$container,o.val()),e=0,r=0,s=void 0!==t.originalEvent;if(f.isEmptyObject(n)||(e=C.textCount(n)),"auto"==C.options.max||C.options.automax)void 0!==(i=C.$el.attr("maxlength"))&&!1!==i?C.options.max=i:C.$container.text("error: [maxlength] attribute not set");else if("autocustom"==C.options.max){var i;void 0!==(i=C.$el.attr(C.options.autoCustomAttr))&&!1!==i?C.options.max=i:C.$container.text("error: ["+C.options.autoCustomAttr+"] attribute not set")}if(r=C.options.countDown?C.options.max-e:e,C.setCount(r),0<C.options.min&&s&&(e<C.options.min?(C.setErrors("min"),C.options.minunder(C.el)):e>=C.options.min&&(C.options.mincount(C.el),C.clearErrors("min"))),-1!==C.options.max)if(e===C.options.max&&0!==C.options.max)C.options.maxcount(C.el),C.clearErrors("max");else if(e>C.options.max&&0!==C.options.max)if(C.options.stopInputAtMaximum){var a="";if("word"==C.options.type)for(var u=n.split(/[^\S\n]/g),c=0;c<u.length&&!(c>=C.options.max);)void 0!==u[c]&&(a+=u[c]+" ",c++);else{var p=C.options.twoCharCarriageReturn?C.options.max-C.twoCharCarriageReturnCount(n):C.options.max;if(C.options.countSpaces)a=n.substring(0,p);else{var l=n.split(""),m=l.length,x=0;for(c=0;x<p&&c<m;)" "!==l[c]&&x++,a+=l[c++]}}o.val(a.trim()),e=C.textCount(o.val()),r=C.options.countDown?C.options.max-e:e,C.setCount(r)}else C.setErrors("max");else C.options.maxunder(C.el),C.clearErrors("max");-1==C.options.minDisplayCutoff&&-1==C.options.maxDisplayCutoff?C.$container.show():e<=C.options.min+C.options.minDisplayCutoff?C.$container.show():-1!==C.options.max&&e>=C.options.max-C.options.maxDisplayCutoff?C.$container.show():C.$container.hide()},C.textCount=function(t){return"word"==C.options.type?C.wordCount(t):C.characterCount(t)},C.wordCount=function(t){return t.trim().replace(/\s+/gi," ").split(" ").length},C.characterCount=function(t){var o=0,n=0;if(C.options.twoCharCarriageReturn&&(n=C.twoCharCarriageReturnCount(t)),o=C.options.countSpaces?t.replace(/[^\S\n|\r|\r\n]/g," ").length:t.replace(/\s/g,"").length,C.options.countExtendedCharacters){var e=t.match(/[^\x00-\xff]/gi);o=null==e?t.length:t.length+e.length}return C.options.twoCharCarriageReturn&&(o+=n),o},C.twoCharCarriageReturnCount=function(t){var o=t.match(/(\r\n|\n|\r)/g),n=0;return null!==o&&(n=o.length),n},C.setCount=function(t){C.$text_counter.text(t)},C.setErrors=function(t){var o=C.$el,n=C.$container,e="";switch(o.addClass(C.options.inputErrorClass),n.addClass(C.options.counterErrorClass),t){case"min":e=C.options.minimumErrorText;break;case"max":e=C.options.maximumErrorText,C.options.countOverflow&&C.setOverflowMessage()}C.options.displayErrorText&&(n.children(".error-text-"+t).length||n.append("<"+C.options.errorTextElement+' class="error-text error-text-'+t+'">'+e+"</"+C.options.errorTextElement+">"))},C.setOverflowMessage=function(){C.hideMessage(C.$container.find("."+C.options.textCountMessageClass)),C.removeOverflowMessage();var t=C.options.countOverflowText.replace("%d",C.textCount(C.$el.val())-C.options.max).replace("%type",C.options.type+"s"),o=C.$container.find("."+C.options.countOverflowContainerClass).append(t);C.showMessage(o)},C.removeOverflowMessage=function(){C.$container.find("."+C.options.countOverflowContainerClass).empty()},C.showMessage=function(t){t.css("display","inline")},C.hideMessage=function(t){t.css("display","none")},C.clearErrors=function(t){var o=C.$el,n=C.$container;n.children(".error-text-"+t).remove(),0==n.children(".error-text").length&&(C.removeOverflowMessage(),C.showMessage(C.$container.find("."+C.options.textCountMessageClass)),o.removeClass(C.options.inputErrorClass),n.removeClass(C.options.counterErrorClass))},C.init()},f.textcounter.defaultOptions={type:"character",min:0,max:200,automax:!1,autoCustomAttr:"counterlimit",countContainerElement:"div",countContainerClass:"text-count-wrapper",textCountMessageClass:"text-count-message",textCountClass:"text-count",inputErrorClass:"error",counterErrorClass:"error",counterText:"Total Count: %d",errorTextElement:"div",minimumErrorText:"Minimum not met",maximumErrorText:"Maximum exceeded",displayErrorText:!0,stopInputAtMaximum:!0,countSpaces:!1,countDown:!1,countDownText:"Remaining: %d",countExtendedCharacters:!1,twoCharCarriageReturn:!1,countOverflow:!1,countOverflowText:"Maximum %type exceeded by %d",countOverflowContainerClass:"text-count-overflow-wrapper",minDisplayCutoff:-1,maxDisplayCutoff:-1,maxunder:function(t){},minunder:function(t){},maxcount:function(t){},mincount:function(t){},init:function(t){}},f.fn.textcounter=function(t){return this.each(function(){new f.textcounter(this,t)})}}(jQuery);